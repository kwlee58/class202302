"0","library(readxl)"
"0","library(magrittr)"
"0","options(width = 180)"
"0","class_roll <- readRDS(""./class_roll_230404.RDS"")"
"0","oxford <- ""../data/oxford_happiness230419.xlsx"" %>%"
"0","  read_excel(range = ""A2:BM907"","
"0","             col_names = FALSE)"
"0","names(oxford) <- c(""Time1"", ""email"", ""Dept"", ""id"", ""Name"", ""Time2"", ""Group"", paste0(""Q"", 1:29, ""_R""), paste0(""Q"", 1:29, ""_B""))"
"0","oxford <- oxford[-2]"
"0","class(oxford$id) <- ""character"""
"0","b <- format(as.POSIXct(oxford$Time2, format = ""%Y-%m-%d %H:%M:%S""), format = ""%H:%M:%S"")"
"0","a <- format(as.POSIXct(oxford$Time1, format = ""%Y-%m-%d %H:%M:%S""), format = ""%H:%M:%S"")"
"0","oxford$Duration <- difftime(as.POSIXct(a, format = ""%H:%M:%S""), as.POSIXct(b, format = ""%H:%M:%S""))"
"0","oxford %<>% cbind(mapply(function(x, y){ifelse(is.na(x), y, x)}, oxford[7:35], oxford[36:64], "
"0","                         USE.NAMES = FALSE))"
"0","names(oxford)[66:94] <- paste0(""Q"", 1:29)"
"0","oxford$Group %<>% "
"0","  factor(levels = c(""Red"", ""Black""))"
